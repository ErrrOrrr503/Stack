stack with some safety features
